<div ng-include="'navbar-top/project.html'"></div>
<div class="project" ng-if="!isDesktop()">
  <div class="project-navigation">
    <div class="btn-group justified">
      <a ui-set="{'projectTab': 'pad'}"
         ui-class="{'active': projectTab == 'pad'}"
         class="nav-pad">
        <span translate>pad.nav.title</span>
        <span class="fa fa-circle notification-indicator" ng-if="hasChanged('pad')"></span> </a>
      <a ui-set="{'projectTab': 'needs'}"
         ui-class="{'active': projectTab == 'needs'}"
         class="nav-needs">
        <span translate>need.nav.title</span>
        <span class="fa fa-circle notification-indicator" ng-if="hasChanged('needs')"></span> </a>

      <a ui-set="{'projectTab': 'chat'}"
         ui-class="{'active': projectTab == 'chat'}"
         class="nav-chat"
         ng-if="project.isParticipant()">
        <span translate>chat.nav.title</span>
        <span class="fa fa-circle notification-indicator" ng-if="hasChanged('chat')"></span> </a>
    </div>
  </div>

  <div class="project-tabs-container" ng-class="{'xs-hidden-tabs': areTabsHidden()}">
    <div ui-state="projectTab" class="project-tabs">
      <div ui-if="projectTab == 'pad'" hm-swipeleft="swipeToNeeds" hm-manager-options='{{hmManagerOpt}}' hm-recognizer-options='{{hmRecognizerOpt}}'>
        <div ng-include="'projects/project-tab.html'"></div>
      </div>

      <div ui-if="projectTab == 'needs'" hm-swipeleft="swipeToChat" hm-swiperight="swipeToPad" hm-manager-options='{{hmManagerOpt}}' hm-recognizer-options='{{hmRecognizerOpt}}'>
        <div class="scrollable">
          <div class="scrollable-content">
            <div need-list project="project" needs="project.needs" ng-class="project.isParticipant() ? '' : 'has-cta'">
            </div>
          </div>
        </div>
      </div>

      <!-- ng-if is not compatible with ui-if -->
      <div ng-if="project.isParticipant()">
        <div ui-if="projectTab == 'chat'" hm-swiperight="swipeToNeeds" hm-manager-options='{{hmManagerOpt}}'  hm-recognizer-options='{{hmRecognizerOpt}}'>
          <chat></chat>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Uses a second modal ui-yield-to. See https://github.com/mcasimir/mobile-angular-ui/pull/286 -->
<div ui-content-for="modals2">
  <modal name="projectTitleReminder">
    <header translate>project.title.reminder.body_one</header>
    <main>
      <strong><p translate>project.title.reminder.body_two</p></strong>
    </main>
    <footer>
      <button class="btn btn-default project-title-reminder-btn" ng-click="cancelProject()" translate>project.title.reminder.button_cancel</button>
      <button class="btn btn-primary project-title-reminder-btn" ng-click="titleReminder()" translate>project.title.reminder.button_continue</button>
    </footer>
  </modal>
</div>
<div ng-if="isDesktop()" class="section project project-desktop">
  <div class="col-md-2">
    <div class="row">
      <div class="col-xs-4 project-photo-responsive">
        <div ui-set="{modalSharedState: {name: 'uploadPicture', callback: uploadProjectPhoto}}" ng-if="project.isParticipant()">
          <img ng-src="{{project.logo()}}">
        </div>
        <div ng-if="!project.isParticipant()">
          <img ng-src="{{project.logo()}}">
        </div>
      </div>
      <div class="col-xs-8">
        <strong>{{project.title}}</strong><br>
        <span class="comma-separated" ng-repeat="c in communities"><a ng-href="{{ c.path() }}">{{ c.name }}</a></span>
      </div>
    </div>
    <div class="row">
      <div project-people></div>
    </div>
    <!--<div class="row">
      <h2>tus teems</h2>
      <projects project-list="projects" context="context"></projects>
    </div>-->
  </div>
  <div class="col-md-7">
    <h1>{{project.title}}</h1>
    <pad editing-default="true" class="flex-container"></pad>
  </div>
  <div class="col-md-3">
    <div class="">
      <h2>necesidades</h2>
      <div need-list project="project" needs="project.needs" display="panel" ng-class="project.isParticipant() ? '' : 'has-cta'" class=""></div>
    </div>
    <div class="flex-container">
      <h2>chat</h2>
      <chat class="flex-container"></chat>
    </div>
  </div>
</div>
